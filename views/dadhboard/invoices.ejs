<% layout('layouts/main') %>

<h1 class="text-xl font-semibold mb-4">My Invoices</h1>

<div class="glass-card rounded-xl overflow-hidden">
  <% if (!invoices.length) { %>
    <div class="p-4 text-xs text-slate-300">
      Belum ada invoice. Silakan pilih paket di halaman Billing.
    </div>
  <% } else { %>
    <table class="min-w-full text-xs">
      <thead class="bg-slate-900/90 border-b border-slate-800">
        <tr>
          <th class="px-3 py-2 text-left">Date</th>
          <th class="px-3 py-2 text-left">Plan</th>
          <th class="px-3 py-2 text-right">Base</th>
          <th class="px-3 py-2 text-right">Unique</th>
          <th class="px-3 py-2 text-right">Final</th>
          <th class="px-3 py-2 text-left">Status</th>
        </tr>
      </thead>
      <tbody>
        <% invoices.forEach(inv => { %>
          <tr class="border-t border-slate-800/70 hover:bg-slate-900/60">
            <td class="px-3 py-2">
              <%= inv.created_at.toISOString().slice(0,19).replace('T',' ') %>
            </td>
            <td class="px-3 py-2"><%= inv.plan_name %></td>
            <td class="px-3 py-2 text-right">Rp <%= inv.base_amount %></td>
            <td class="px-3 py-2 text-right"><%= inv.unique_code %></td>
            <td class="px-3 py-2 text-right">Rp <%= inv.final_amount %></td>
            <td class="px-3 py-2">
              <% if (inv.status === 'paid') { %>
                <span class="px-2 py-0.5 rounded-full bg-emerald-900/40 text-emerald-300 text-[11px]">
                  PAID
                </span>
              <% } else if (inv.status === 'pending') { %>
                <span class="px-2 py-0.5 rounded-full bg-amber-900/40 text-amber-300 text-[11px]">
                  PENDING
                </span>
              <% } else { %>
                <span class="px-2 py-0.5 rounded-full bg-slate-800 text-slate-300 text-[11px]">
                  <%= inv.status.toUpperCase() %>
                </span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</div>

<div class="mt-4">
  <a href="/dashboard/billing"
     class="text-[11px] px-3 py-1 rounded border border-slate-700 hover:bg-slate-800">
    Kembali ke Billing
  </a>
</div>
